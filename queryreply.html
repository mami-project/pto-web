<!DOCTYPE html>
<html>
<title>PTO - Query Reply</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
<style>
  
  label {
    display: block;
  }
  
  </style>
<script scr="layout.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<!--<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>-->
<script src="uploads.js"></script>
<script src="iql.js"></script>
<script src="query.js"></script>
<script src="results.js"></script>
<!--<script src="qui.js"></script>-->
<script type="text/javascript">

/**
 * openwin
 * 
 * Show in other window (if still open)
 */
function openwin(displayname) {
  var mainwin = window.open('index.html','PTOMain');
  mainwin.focus();
  mainwin.document.getElementById(displayname).style.display='block';
}

/**
 * loadResults
 *
 * Download results from server. Reads window.location for the query id
 */
function loadResults() {
  var id = window.location.search.substring(1);
  if(id.length > 1) {
    getResults(id);
  }
  else
   console.log('no query string');
}
</script>
<body onload="loadResults()">

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-black w3-card-2 w3-left-align w3-large">
    <!--<a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-red" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>-->
    <div class="w3-bar-item w3-button w3-padding-large w3-white"  onclick="var mainwin = window.open('index.html','PTOMain');mainwin.focus();">Home<!--<image src="img/pto.png" style="max-height:41px"/>--></div>
    <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="openwin('runquery')">Run New Query</a>
    <!--<a href="#queryqueue-header" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="getSummaryQQ();document.getElementById('queryqueue').style.display='block'">Query Queue</a>
    <a href="#uploadstats-header" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="getUploadStats();document.getElementById('uploadstats').style.display='block'">Upload statistics</a>-->
    
    <div class="w3-display-right">
   <a href="https://mami-project.eu" class="w3-bar-item w3-button w3-hide-small w3-padding-small w3-white w3-hover-white"><img style="height: 2.7rem" src="img/logo.png" alt="Go to MAMI project"/></a>
   </div>
  </div>
  
  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
    <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="document.getElementById('runquery').style.display='block'">Run New Query</a>
    <a href="#queryqueue-header" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="getSummaryQQ();document.getElementById('queryqueue').style.display='block'">Query Queue</a>
    <a href="#uploadstats-header" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="getUploadStats();document.getElementById('uploadstats').style.display='block'">Upload statistics</a>
  </div>
</div>
  


<!-- Header -->
<!--<header class="w3-container w3-theme w3-padding" id="ptoheader">
  <div class="w3-center">
  <h4>Path Transparency Observatory</h4>
  <h1 class="w3-xxxlarge"><b>P</b>ath <b>T</b>ransparency <b>O</b>bservatory</h1>
    <p><image src="img/pto-black.png" /></p>
    <p>An open-source, public repository for measurement of path transparency and <br>
    impairments on new and existing network protocols in the Internet.</p>
    <div class="w3-padding-32">
      <button class="w3-btn w3-xlarge w3-dark-grey w3-hover-light-grey" onclick="document.getElementById('runquery').style.display='block'" style="font-weight:900;">Query Observations</button>
    </div>
  </div>
</header>-->

<br>
<br>
<br>

<div class="w3-padding w3-white w3-display-container">
<div id="results" style="display: none" class="w3-padding w3-card-4">
  <h1>Query Result</h1>
  <div id="results_msg" style="display: none">
  </div>

  <div id="chart_sec"  style="display: none">
    <h2>Chart</h2>
    <div id="chart">
      <div id="title"></div>
      <form>
        <label><input type="radio" name="mode" value="grouped" id="grouped"> Grouped</label>
        <label id="label_stacked"><input type="radio" name="mode" value="stacked" id="stacked" checked> Stacked</label>
      </form>
      <svg id="chart-svg"></svg>
    </div>
  </div>


  <div id="chart_section"  style="display: none">
    <h2>Chart</h2>
    <div id="figures">
    </div>
  </div>
     
  <div id="table_section"  style="display: none">
    <h2>Raw table</h2>
    <div class="w3-table w3-striped w3-bordered" id="tables">
    </div>
  </div>

  <div id="raw_query_section"  style="display: none">
    <h2>Query</h2>
    <div class="auto-overflow">
      <code id="raw_query"></code>
    </div>
  </div>

  <div id="raw_results_section"  style="display: none">
    <h2>Raw response</h2>
    <div class="auto-overflow" id="raw_results">
    </div>
  </div>
</div>
</div>

<!-- Footer -->
<footer class="w3-container w3-theme-dark w3-padding-16">
  <p>The PTO is developed and maintained by the H2020 ICT <a href="mami-project.eu">MAMI project.</a></p>
  <p class="w3-text-grey w3-tiny">This project has received funding from the European Union's Horizon 2020 research and innovation programme under grant 
                agreement No 688421, and was supported by the Swiss State Secretariat for Education, Research and
                Innovation (SERI) under contract number 15.0268. The opinions expressed and
                arguments employed reflect only the authors' views. The European Commission is
                not responsible for any use that may be made of that information. Further, the
                opinions expressed and arguments employed herein do not necessarily reflect
                the official views of the Swiss Government.
<img src="img/eu_flag_small.jpg" style="width: 2rem"></p>

              
</footer>


</body>
<!-- <script>
  
  var n = 4, // The number of series.
      m = 8; // The number of values per series.
  
  // The xz array has m elements, representing the x-values shared by all series.
  // The yz array has n elements, representing the y-values of each of the n series.
  // Each yz[i] is an array of m non-negative numbers representing a y-value for xz[i].
  // The y01z array has the same structure as yz, but with stacked [y₀, y₁] instead of y.
  var xz = d3.range(m),
      yz = d3.range(n).map(function() { return bumps(m); }),
      y01z = d3.stack().keys(d3.range(n))(d3.transpose(yz)),
      yMax = d3.max(yz, function(y) { return d3.max(y); }),
      y1Max = d3.max(y01z, function(y) { return d3.max(y, function(d) { return d[1]; }); });
  
  var svg = d3.select("#chart-svg"),
      margin = {top: 40, right: 10, bottom: 20, left: 10},
      width = +svg.attr("width") - margin.left - margin.right,
      height = +svg.attr("height") - margin.top - margin.bottom,
      g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
  var x = d3.scaleBand()
      .domain(xz)
      .rangeRound([0, width])
      .padding(0.08);
  
  var y = d3.scaleLinear()
      .domain([0, y1Max])
      .range([height, 0]);
  
  var color = d3.scaleOrdinal()
      .domain(d3.range(n))
      .range(d3.schemeCategory20c);
  
  var series = g.selectAll(".series")
    .data(y01z)
    .enter().append("g")
      .attr("fill", function(d, i) { return color(i); });
  
  var rect = series.selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("x", function(d, i) { return x(i); })
      .attr("y", height)
      .attr("width", x.bandwidth())
      .attr("height", 0);
  
  rect.transition()
      .delay(function(d, i) { return i * 10; })
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return y(d[0]) - y(d[1]); });
  
  g.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x)
          .tickSize(0)
          .tickPadding(6));
  
  d3.selectAll("input")
      .on("change", changed);
  
  var timeout = d3.timeout(function() {
    d3.select("input[value=\"grouped\"]")
        .property("checked", true)
        .dispatch("change");
  }, 2000);
  
  function changed() {
    timeout.stop();
    if (this.value === "grouped") transitionGrouped();
    else transitionStacked();
  }
  
  function transitionGrouped() {
    y.domain([0, yMax]);
  
    rect.transition()
        .duration(500)
        .delay(function(d, i) { return i * 10; })
        .attr("x", function(d, i) { return x(i) + x.bandwidth() / n * this.parentNode.__data__.key; })
        .attr("width", x.bandwidth() / n)
      .transition()
        .attr("y", function(d) { return y(d[1] - d[0]); })
        .attr("height", function(d) { return y(0) - y(d[1] - d[0]); });
  }
  
  function transitionStacked() {
    y.domain([0, y1Max]);
  
    rect.transition()
        .duration(500)
        .delay(function(d, i) { return i * 10; })
        .attr("y", function(d) { return y(d[1]); })
        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
      .transition()
        .attr("x", function(d, i) { return x(i); })
        .attr("width", x.bandwidth());
  }
  
  // Returns an array of m psuedorandom, smoothly-varying non-negative numbers.
  // Inspired by Lee Byron’s test data generator.
  // http://leebyron.com/streamgraph/
  function bumps(m) {
    var values = [], i, j, w, x, y, z;
  
    // Initialize with uniform random values in [0.1, 0.2).
    for (i = 0; i < m; ++i) {
      values[i] = 0.1 + 0.1 * Math.random();
    }
  
    // Add five random bumps.
    for (j = 0; j < 5; ++j) {
      x = 1 / (0.1 + Math.random());
      y = 2 * Math.random() - 0.5;
      z = 10 / (0.1 + Math.random());
      for (i = 0; i < m; i++) {
        w = (i / m - y) * z;
        values[i] += x * Math.exp(-w * w);
      }
    }
  
    // Ensure all values are positive.
    for (i = 0; i < m; ++i) {
      values[i] = Math.max(0, values[i]);
    }
  
    return values;
  }
  
  </script> -->
</html>
